Obiettivo

âœ… Indicatore di drop tra due task (segue il mouse)
âœ… Senza creare un â€œbucoâ€ doppio
âœ… Senza far sparire task

La soluzione piÃ¹ pulita Ã¨:

lasciare provided.placeholder UNA SOLA VOLTA (serve al layout DnD, ma non lo usi come indicatore visivo)

creare un DropIndicator â€œvisivoâ€ a altezza zero tra le task (una riga/border), usando lastValidDragIndex + draggingOverCleanerId che giÃ  gestisci in generate-assignments.tsx (li resetti in onDragEnd) 

generate-assignments

Scaletta modifiche (copiaincolla)
1) timeline-view.tsx â€” elimina il placeholder â€œin mezzoâ€ e lo hide della TaskCard
TROVA e RIMUOVI questi pezzi:

A) Questo placeholder â€œin mezzoâ€:

{draggedTaskIndex !== null && draggedTaskIndex === idx && provided.placeholder}


timeline-view

B) Questa logica che non renderizza la card (fa â€œsparireâ€ roba):

{!(draggedTaskIndex !== null && draggedTaskIndex === idx) && (
  <TaskCard ... />
)}


timeline-view

2) timeline-view.tsx â€” aggiungi un â€œDropIndicatorâ€ visivo tra le task (senza altezza)

Nel punto della .map((task, idx) => ...) prima di <TaskCard />, aggiungi:

const showDropIndicator =
  draggingOverCleanerId === cleaner.id &&
  lastValidDragIndex !== null &&
  lastValidDragIndex === idx;

{showDropIndicator && (
  <div className="h-0 border-t-4 border-custom-blue my-1 rounded" />
)}

<TaskCard ... />


ğŸ‘‰ Questo crea una linea tra due task, che â€œsegueâ€ lâ€™indice di drop, senza aggiungere uno spazio vuoto (h-0).

Se vuoi un indicatore piÃ¹ â€œcicciottoâ€, invece di h-0 fai h-2 ma allora stai aggiungendo spazio: io te lo sto dando â€œsolo indicatoreâ€.

3) timeline-view.tsx â€” lascia provided.placeholder SOLO una volta (in fondo)

Tieni questo (va bene cosÃ¬):

{provided.placeholder}


e rimuovi la condizione che lo rende â€œsolo se draggedTaskIndexâ€¦â€ (perchÃ© ora non vuoi piÃ¹ quella logica). Attualmente lo hai condizionato qui: 

timeline-view

Quindi sostituisci:

{(draggedTaskIndex === null || draggedTaskIndex >= cleanerTasks.length) && provided.placeholder}


con:

{provided.placeholder}

PerchÃ© cosÃ¬ funziona (in 1 riga)

provided.placeholder resta a fare il suo lavoro â€œtecnicoâ€ per il layout

lâ€™indicatore visivo Ã¨ una riga a altezza zero: non puÃ² generare â€œdoppio bucoâ€

non nascondi mai task â†’ niente sparizioni