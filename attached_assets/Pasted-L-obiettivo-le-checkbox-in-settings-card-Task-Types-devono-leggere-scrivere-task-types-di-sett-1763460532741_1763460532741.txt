L‚Äôobiettivo: le checkbox in /settings ‚Üí card ‚ÄúTask Types‚Äù devono leggere/scrivere task_types di settings.json e NON essere pi√π grigie/disabled.

1. Aggiungi TaskTypeRules e task_types all‚Äôinterfaccia in system-settings.tsx

File: client/src/pages/system-settings.tsx

Subito dopo gli import (dove ci sono gi√† interface Client e interface SettingsData), modifica cos√¨:

üîß Prima (semplificato)
interface SettingsData {
  "early-out": {
    eo_start_time: string;
    eo_time: string;
    eo_clients: number[];
  };
  "high-priority": {
    hp_start_time: string;
    hp_time: string;
    hp_clients: number[];
  };
  dedupe_strategy: string;
  apartment_types: {
    standard_apt: string[];
    premium_apt: string[];
    formatore_apt: string[];
  };
}

‚úÖ Dopo
interface TaskTypeRules {
  standard_cleaner: boolean;
  premium_cleaner: boolean;
  straordinaria_cleaner: boolean;
  formatore_cleaner: boolean;
}

interface SettingsData {
  "early-out": {
    eo_start_time: string;
    eo_time: string;
    eo_clients: number[];
  };
  "high-priority": {
    hp_start_time: string;
    hp_time: string;
    hp_clients: number[];
  };
  dedupe_strategy: string;
  apartment_types: {
    standard_apt: string[];
    premium_apt: string[];
    formatore_apt: string[];
  };
  task_types: {
    standard_apt: TaskTypeRules;
    premium_apt: TaskTypeRules;
    straordinario_apt: TaskTypeRules;
  };
}


Cos√¨ settings conterr√† anche task_types in modo tipizzato.

2. Aggiungi la funzione updateTaskTypeRule

Sempre in system-settings.tsx, sotto const handleClientToggle = (...) => { ... } aggiungi:

  const updateTaskTypeRule = (
    aptType: keyof SettingsData["task_types"],
    cleanerType: keyof TaskTypeRules,
    value: boolean
  ) => {
    setSettings(prev => {
      if (!prev) return prev;

      return {
        ...prev,
        task_types: {
          ...prev.task_types,
          [aptType]: {
            ...prev.task_types[aptType],
            [cleanerType]: value,
          },
        },
      };
    });
  };

3. Sostituisci la card ‚ÄúTask Types‚Äù statica con una dinamica

Nello stesso file, trova il blocco commentato:

{/* Task Types - Tipi di appartamento che i cleaner possono fare */}
<Card className="bg-custom-blue-light border-2 border-custom-blue">
  ...
</Card>


(circa da Task Types - Tipi di appartamento che i cleaner possono gestire in poi, al momento √® pieno di <input type="checkbox" ... disabled />).

üëâ Cancella TUTTO il contenuto di quella card e sostituiscilo con questo:

          {/* Task Types - Tipi di appartamento che i cleaner possono fare */}
          <Card className="bg-custom-blue-light border-2 border-custom-blue">
            <CardHeader className="bg-custom-blue-light py-3">
              <CardTitle className="text-lg">Task Types</CardTitle>
              <CardDescription className="text-xs">
                Tipi di appartamento che ogni categoria di cleaner pu√≤ gestire
              </CardDescription>
            </CardHeader>
            <CardContent className="bg-custom-blue-light">
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {/* Appartamento Standard */}
                <div className="space-y-3">
                  <div className="border-b pb-2 flex items-center gap-2">
                    <Badge variant="outline" className="bg-white text-custom-blue border-custom-blue">
                      Standard Apt
                    </Badge>
                    <span className="text-xs text-muted-foreground">
                      Seleziona quali cleaner possono fare gli appartamenti standard
                    </span>
                  </div>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="std-standard"
                        checked={settings.task_types.standard_apt.standard_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("standard_apt", "standard_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="std-standard" className="text-sm cursor-pointer">
                        Standard Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="std-premium"
                        checked={settings.task_types.standard_apt.premium_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("standard_apt", "premium_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="std-premium" className="text-sm cursor-pointer">
                        Premium Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="std-straordinaria"
                        checked={settings.task_types.standard_apt.straordinaria_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("standard_apt", "straordinaria_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="std-straordinaria" className="text-sm cursor-pointer">
                        Straordinaria Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="std-formatore"
                        checked={settings.task_types.standard_apt.formatore_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("standard_apt", "formatore_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="std-formatore" className="text-sm cursor-pointer">
                        Cleaner Formatore
                      </Label>
                    </div>
                  </div>
                </div>

                {/* Appartamento Premium */}
                <div className="space-y-3">
                  <div className="border-b pb-2 flex items-center gap-2">
                    <Badge variant="outline" className="bg-white text-custom-blue border-custom-blue">
                      Premium Apt
                    </Badge>
                    <span className="text-xs text-muted-foreground">
                      Seleziona quali cleaner possono fare gli appartamenti premium
                    </span>
                  </div>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="prem-standard"
                        checked={settings.task_types.premium_apt.standard_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("premium_apt", "standard_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="prem-standard" className="text-sm cursor-pointer">
                        Standard Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="prem-premium"
                        checked={settings.task_types.premium_apt.premium_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("premium_apt", "premium_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="prem-premium" className="text-sm cursor-pointer">
                        Premium Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="prem-straordinaria"
                        checked={settings.task_types.premium_apt.straordinaria_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("premium_apt", "straordinaria_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="prem-straordinaria" className="text-sm cursor-pointer">
                        Straordinaria Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="prem-formatore"
                        checked={settings.task_types.premium_apt.formatore_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("premium_apt", "formatore_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="prem-formatore" className="text-sm cursor-pointer">
                        Cleaner Formatore
                      </Label>
                    </div>
                  </div>
                </div>

                {/* Appartamento Straordinario */}
                <div className="space-y-3">
                  <div className="border-b pb-2 flex items-center gap-2">
                    <Badge variant="outline" className="bg-white text-custom-blue border-custom-blue">
                      Straordinario Apt
                    </Badge>
                    <span className="text-xs text-muted-foreground">
                      Seleziona quali cleaner possono fare gli straordinari
                    </span>
                  </div>
                  <div className="space-y-2">
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="straord-standard"
                        checked={settings.task_types.straordinario_apt.standard_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("straordinario_apt", "standard_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="straord-standard" className="text-sm cursor-pointer">
                        Standard Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="straord-premium"
                        checked={settings.task_types.straordinario_apt.premium_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("straordinario_apt", "premium_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="straord-premium" className="text-sm cursor-pointer">
                        Premium Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="straord-straordinaria"
                        checked={settings.task_types.straordinario_apt.straordinaria_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("straordinario_apt", "straordinaria_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="straord-straordinaria" className="text-sm cursor-pointer">
                        Straordinaria Cleaner
                      </Label>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Checkbox
                        id="straord-formatore"
                        checked={settings.task_types.straordinario_apt.formatore_cleaner}
                        onCheckedChange={(checked) =>
                          updateTaskTypeRule("straordinario_apt", "formatore_cleaner", !!checked)
                        }
                      />
                      <Label htmlFor="straord-formatore" className="text-sm cursor-pointer">
                        Cleaner Formatore
                      </Label>
                    </div>
                  </div>
                </div>
              </div>
            </CardContent>
          </Card>